# ë°°í¬ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

YouTube Downloader ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê¸° ìœ„í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ–¥ï¸ ì„œë²„ ìš”êµ¬ì‚¬í•­

### ìµœì†Œ ì‚¬ì–‘
- **CPU**: 2 ì½”ì–´ ì´ìƒ
- **RAM**: 2GB ì´ìƒ
- **ë””ìŠ¤í¬**: 10GB ì´ìƒ (ë‹¤ìš´ë¡œë“œ íŒŒì¼ ì €ì¥ ê³µê°„ ë³„ë„)
- **OS**: Linux (Ubuntu 20.04+ ê¶Œì¥), Windows Server, macOS

### ê¶Œì¥ ì‚¬ì–‘
- **CPU**: 4 ì½”ì–´ ì´ìƒ
- **RAM**: 4GB ì´ìƒ
- **ë””ìŠ¤í¬**: 50GB ì´ìƒ SSD
- **ë„¤íŠ¸ì›Œí¬**: 100Mbps ì´ìƒ

### ì†Œí”„íŠ¸ì›¨ì–´
- **Python**: 3.13 ì´ìƒ
- **FFmpeg**: ìµœì‹  ë²„ì „
- **Nginx** ë˜ëŠ” **Apache**: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œìš© (ì„ íƒì‚¬í•­)

---

## ğŸš€ ë°°í¬ ë°©ë²•

### 1. ê¸°ë³¸ ë°°í¬ (Uvicorn)

#### ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/space-cap/youtube-downloader-cli.git
cd youtube-downloader-cli

# ê°€ìƒí™˜ê²½ ìƒì„± ë° ì˜ì¡´ì„± ì„¤ì¹˜
uv venv
uv pip install -e .
```

#### ì‹¤í–‰

```bash
# í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì‹¤í–‰
uvicorn youtube_downloader.web.app:app --host 0.0.0.0 --port 8000 --workers 4
```

**ì˜µì…˜ ì„¤ëª…**:
- `--host 0.0.0.0`: ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì ‘ì† í—ˆìš©
- `--port 8000`: í¬íŠ¸ ë²ˆí˜¸
- `--workers 4`: ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ ìˆ˜ (CPU ì½”ì–´ ìˆ˜ì— ë§ê²Œ ì¡°ì •)

---

### 2. Docker ë°°í¬ (ê¶Œì¥)

#### Dockerfile

```dockerfile
FROM python:3.13-slim

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# ì‹œìŠ¤í…œ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apt-get update && apt-get install -y \\
    ffmpeg \\
    && rm -rf /var/lib/apt/lists/*

# Python ì˜ì¡´ì„± ì„¤ì¹˜
COPY pyproject.toml ./
RUN pip install --no-cache-dir uv && \\
    uv pip install --system -e .

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë³µì‚¬
COPY . .

# í¬íŠ¸ ë…¸ì¶œ
EXPOSE 8000

# ë‹¤ìš´ë¡œë“œ ë””ë ‰í† ë¦¬ ìƒì„±
RUN mkdir -p /app/downloads

# ì„œë²„ ì‹¤í–‰
CMD ["uvicorn", "youtube_downloader.web.app:app", "--host", "0.0.0.0", "--port", "8000", "--workers", "4"]
```

#### docker-compose.yml

```yaml
version: '3.8'

services:
  youtube-downloader:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - ./downloads:/app/downloads
    environment:
      - PYTHONUNBUFFERED=1
    restart: unless-stopped
```

#### ì‹¤í–‰

```bash
# ì´ë¯¸ì§€ ë¹Œë“œ
docker-compose build

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

---

### 3. Nginx ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ

#### Nginx ì„¤ì •

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # í´ë¼ì´ì–¸íŠ¸ ìµœëŒ€ ì—…ë¡œë“œ í¬ê¸°
    client_max_body_size 100M;

    # ì •ì  íŒŒì¼
    location /static {
        alias /path/to/youtube-downloader-cli/src/youtube_downloader/web/static;
    }

    # WebSocket
    location /ws {
        proxy_pass http://127.0.0.1:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_read_timeout 86400;
    }

    # API ë° ì›¹ í˜ì´ì§€
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### SSL ì„¤ì • (Let's Encrypt)

```bash
# Certbot ì„¤ì¹˜
sudo apt-get install certbot python3-certbot-nginx

# SSL ì¸ì¦ì„œ ë°œê¸‰
sudo certbot --nginx -d your-domain.com

# ìë™ ê°±ì‹  ì„¤ì •
sudo certbot renew --dry-run
```

---

### 4. Systemd ì„œë¹„ìŠ¤ (Linux)

#### ì„œë¹„ìŠ¤ íŒŒì¼ ìƒì„±

`/etc/systemd/system/youtube-downloader.service`:

```ini
[Unit]
Description=YouTube Downloader Web Service
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/path/to/youtube-downloader-cli
Environment="PATH=/path/to/youtube-downloader-cli/.venv/bin"
ExecStart=/path/to/youtube-downloader-cli/.venv/bin/uvicorn youtube_downloader.web.app:app --host 0.0.0.0 --port 8000 --workers 4
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### ì„œë¹„ìŠ¤ ê´€ë¦¬

```bash
# ì„œë¹„ìŠ¤ í™œì„±í™”
sudo systemctl enable youtube-downloader

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start youtube-downloader

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status youtube-downloader

# ë¡œê·¸ í™•ì¸
sudo journalctl -u youtube-downloader -f
```

---

## âš™ï¸ í™˜ê²½ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜

`.env` íŒŒì¼ ìƒì„±:

```bash
# ì„œë²„ ì„¤ì •
HOST=0.0.0.0
PORT=8000
WORKERS=4

# CORS ì„¤ì •
ALLOWED_ORIGINS=https://your-domain.com

# ë‹¤ìš´ë¡œë“œ ë””ë ‰í† ë¦¬
DOWNLOAD_DIR=/app/downloads
TEMP_DIR=/app/downloads/temp

# ë¡œê·¸ ë ˆë²¨
LOG_LEVEL=INFO
```

### CORS ì„¤ì •

í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” `app.py`ì˜ CORS ì„¤ì •ì„ ìˆ˜ì •í•˜ì„¸ìš”:

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["https://your-domain.com"],  # íŠ¹ì • ë„ë©”ì¸ë§Œ í—ˆìš©
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

## ğŸ”’ ë³´ì•ˆ ì„¤ì •

### 1. ë°©í™”ë²½ ì„¤ì •

```bash
# UFW (Ubuntu)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### 2. Rate Limiting

Nginxì—ì„œ Rate Limiting ì„¤ì •:

```nginx
http {
    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
    
    server {
        location /api {
            limit_req zone=api burst=20;
        }
    }
}
```

### 3. íŒŒì¼ ê¶Œí•œ

```bash
# ë‹¤ìš´ë¡œë“œ ë””ë ‰í† ë¦¬ ê¶Œí•œ ì„¤ì •
chmod 755 downloads
chown -R www-data:www-data downloads
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### ë¡œê·¸ í™•ì¸

```bash
# Uvicorn ë¡œê·¸
tail -f /var/log/youtube-downloader/access.log

# ì—ëŸ¬ ë¡œê·¸
tail -f /var/log/youtube-downloader/error.log
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```bash
# CPU ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
htop

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h

# ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½
iftop
```

---

## ğŸ”§ ìœ ì§€ë³´ìˆ˜

### ì—…ë°ì´íŠ¸

```bash
# ì½”ë“œ ì—…ë°ì´íŠ¸
git pull origin main

# ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
uv pip install -e . --upgrade

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart youtube-downloader
```

### ë°±ì—…

```bash
# ë‹¤ìš´ë¡œë“œ íŒŒì¼ ë°±ì—…
tar -czf downloads-backup-$(date +%Y%m%d).tar.gz downloads/

# ì„¤ì • íŒŒì¼ ë°±ì—…
cp .env .env.backup
```

### ì •ë¦¬

```bash
# ì˜¤ë˜ëœ ë‹¤ìš´ë¡œë“œ íŒŒì¼ ì‚­ì œ (7ì¼ ì´ìƒ)
find downloads/ -type f -mtime +7 -delete

# ì„ì‹œ íŒŒì¼ ì •ë¦¬
rm -rf downloads/temp/*
```

---

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•Šì•„ìš”
- Python ë²„ì „ í™•ì¸: `python --version`
- ì˜ì¡´ì„± ì„¤ì¹˜ í™•ì¸: `uv pip list`
- í¬íŠ¸ ì¶©ëŒ í™•ì¸: `lsof -i :8000`

### WebSocket ì—°ê²°ì´ ì•ˆ ë¼ìš”
- Nginx ì„¤ì • í™•ì¸ (WebSocket í”„ë¡ì‹œ)
- ë°©í™”ë²½ ì„¤ì • í™•ì¸
- ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬ í™•ì¸

### ë‹¤ìš´ë¡œë“œê°€ ëŠë ¤ìš”
- ë„¤íŠ¸ì›Œí¬ ì†ë„ í™•ì¸
- ì„œë²„ ë¦¬ì†ŒìŠ¤ í™•ì¸ (CPU, ë©”ëª¨ë¦¬)
- ì›Œì»¤ ìˆ˜ ì¦ê°€ ê³ ë ¤

### ë””ìŠ¤í¬ ê³µê°„ì´ ë¶€ì¡±í•´ìš”
- ì˜¤ë˜ëœ íŒŒì¼ ì •ë¦¬
- ìë™ ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •
- ë””ìŠ¤í¬ ìš©ëŸ‰ ì¦ì„¤

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [FastAPI ë°°í¬ ê°€ì´ë“œ](https://fastapi.tiangolo.com/deployment/)
- [Uvicorn ë°°í¬ ê°€ì´ë“œ](https://www.uvicorn.org/deployment/)
- [Nginx ê³µì‹ ë¬¸ì„œ](https://nginx.org/en/docs/)
- [Docker ê³µì‹ ë¬¸ì„œ](https://docs.docker.com/)

---

## ğŸ’¡ ì¶”ê°€ ê¶Œì¥ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
- Redisë¥¼ ì‚¬ìš©í•œ ì‘ì—… í êµ¬í˜„
- CDN ì‚¬ìš© (ì •ì  íŒŒì¼)
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ë§

### í™•ì¥ì„±
- ë¡œë“œ ë°¸ëŸ°ì„œ ì‚¬ìš©
- ì—¬ëŸ¬ ì„œë²„ì— ë¶„ì‚° ë°°í¬
- ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •

### ëª¨ë‹ˆí„°ë§ ë„êµ¬
- Prometheus + Grafana
- Sentry (ì—ëŸ¬ ì¶”ì )
- New Relic (APM)
