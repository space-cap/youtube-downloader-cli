# 유튜브 다운로더 웹 인터페이스 작업 계획서

## 📋 프로젝트 개요

### 목적
기존 CLI 기반 유튜브 다운로더에 웹 인터페이스를 추가하여 브라우저에서 URL을 입력하면 동영상/오디오를 다운로드할 수 있는 웹 애플리케이션을 개발합니다.

### 핵심 가치
- **접근성 향상**: CLI에 익숙하지 않은 사용자도 쉽게 사용
- **코드 재사용**: 기존 다운로더 모듈을 백엔드 API로 활용
- **사용자 경험**: 직관적인 UI와 실시간 진행률 표시

---

## 🎯 주요 기능

### 필수 기능 (MVP)
- ✅ URL 입력 폼
- ✅ 화질/음질 선택 옵션
- ✅ 다운로드 버튼
- ✅ 실시간 진행률 표시
- ✅ 파일 다운로드

### 추가 기능
- 📋 동영상 정보 미리보기 (제목, 썸네일, 길이)
- 🎵 오디오 전용 다운로드 (32~320kbps 선택)
- 📊 사용 가능한 포맷 목록 표시
- 💾 다운로드 이력 (로컬 스토리지)
- 🌙 다크 모드 지원

---

## 🛠 기술 스택

### 백엔드
- **FastAPI**: 고성능 Python 웹 프레임워크
  - 비동기 처리 지원
  - 자동 API 문서 생성 (Swagger)
  - WebSocket 지원 (실시간 진행률)
- **기존 모듈 재사용**: `youtube_downloader` 패키지

### 프론트엔드
- **HTML5 + Vanilla CSS**: 가볍고 빠른 UI
- **Vanilla JavaScript**: 프레임워크 없이 순수 JS
  - Fetch API로 백엔드 통신
  - WebSocket으로 실시간 업데이트
- **반응형 디자인**: 모바일/태블릿/데스크톱 지원

### 배포 (선택사항)
- **Docker**: 컨테이너화
- **Nginx**: 리버스 프록시
- **Uvicorn**: ASGI 서버

---

## 📁 프로젝트 구조

```
YoutubeDownloaderCli/
├── src/
│   └── youtube_downloader/
│       ├── __init__.py
│       ├── cli.py              # 기존 CLI
│       ├── downloader.py       # 기존 다운로더 (재사용)
│       ├── config.py
│       ├── utils.py
│       ├── models.py
│       └── web/                # 🆕 웹 인터페이스
│           ├── __init__.py
│           ├── app.py          # FastAPI 애플리케이션
│           ├── api.py          # API 엔드포인트
│           ├── websocket.py    # WebSocket 핸들러
│           └── static/         # 정적 파일
│               ├── index.html
│               ├── style.css
│               └── app.js
├── tests/
│   ├── test_downloader.py
│   └── test_web_api.py         # 🆕 웹 API 테스트
├── docs/
│   └── web/                    # 🆕 웹 관련 문서
│       ├── 01-웹-인터페이스-작업-계획서.md
│       ├── 02-API-명세서.md
│       └── 03-배포-가이드.md
├── downloads/
├── pyproject.toml              # FastAPI 의존성 추가
└── README.md
```

---

## 🎨 UI/UX 설계

### 메인 페이지 레이아웃

```
┌─────────────────────────────────────────────┐
│  🎥 YouTube Downloader                      │
├─────────────────────────────────────────────┤
│                                             │
│  [URL 입력 필드                          ] │
│                                             │
│  ┌─────────────┐  ┌──────────────┐        │
│  │ 화질 선택    │  │ 오디오 품질   │        │
│  │ ▼ 1080p     │  │ ▼ 192kbps    │        │
│  └─────────────┘  └──────────────┘        │
│                                             │
│  [ ] 오디오만 다운로드                      │
│  [ ] 메타데이터 저장                        │
│                                             │
│  [      다운로드      ]                     │
│                                             │
│  ┌─────────────────────────────────────┐  │
│  │ 진행률: ████████░░░░░░░░ 45%        │  │
│  │ 속도: 2.5 MB/s | 남은 시간: 00:15   │  │
│  └─────────────────────────────────────┘  │
│                                             │
└─────────────────────────────────────────────┘
```

### 주요 UI 컴포넌트
1. **URL 입력 필드**: 유튜브 링크 입력
2. **옵션 선택**: 드롭다운 메뉴
3. **진행률 바**: 실시간 업데이트
4. **다운로드 버튼**: 상태에 따라 변경 (준비/다운로드 중/완료)
5. **에러 메시지**: 사용자 친화적인 에러 표시

---

## 🔌 API 설계

### REST API 엔드포인트

#### 1. 동영상 정보 조회
```http
GET /api/video/info?url={youtube_url}

Response:
{
  "title": "영상 제목",
  "duration": 180,
  "thumbnail": "https://...",
  "uploader": "채널명",
  "formats": [
    {"format_id": "137", "ext": "mp4", "resolution": "1080p"},
    {"format_id": "22", "ext": "mp4", "resolution": "720p"}
  ]
}
```

#### 2. 다운로드 시작
```http
POST /api/download

Request Body:
{
  "url": "https://youtube.com/watch?v=...",
  "quality": "1080p",
  "audio_only": false,
  "audio_quality": "192"
}

Response:
{
  "task_id": "abc123",
  "status": "started"
}
```

#### 3. 다운로드 상태 조회
```http
GET /api/download/{task_id}/status

Response:
{
  "status": "downloading",
  "progress": 45,
  "speed": "2.5 MB/s",
  "eta": "00:15"
}
```

#### 4. 파일 다운로드
```http
GET /api/download/{task_id}/file

Response: Binary file stream
```

### WebSocket 엔드포인트

```
WS /ws/download/{task_id}

Messages:
{
  "type": "progress",
  "progress": 45,
  "downloaded": "15.2 MB",
  "total": "33.8 MB",
  "speed": "2.5 MB/s",
  "eta": "00:15"
}

{
  "type": "complete",
  "file_path": "/downloads/video.mp4"
}

{
  "type": "error",
  "message": "다운로드 실패: ..."
}
```

---

## 🎯 개발 단계

### Phase 1: 백엔드 API 개발 (2일)

#### 1.1 FastAPI 프로젝트 설정
- [x] FastAPI 의존성 추가
- [ ] 기본 앱 구조 생성
- [ ] CORS 설정
- [ ] 정적 파일 서빙 설정

#### 1.2 API 엔드포인트 구현
- [ ] `/api/video/info` - 동영상 정보 조회
- [ ] `/api/download` - 다운로드 시작
- [ ] `/api/download/{task_id}/status` - 상태 조회
- [ ] `/api/download/{task_id}/file` - 파일 다운로드

#### 1.3 WebSocket 구현
- [ ] WebSocket 연결 관리
- [ ] 실시간 진행률 전송
- [ ] 에러 처리

#### 1.4 백그라운드 작업 처리
- [ ] 비동기 다운로드 작업 큐
- [ ] 임시 파일 관리
- [ ] 자동 정리 (다운로드 후 1시간)

### Phase 2: 프론트엔드 개발 (2일)

#### 2.1 HTML 구조
- [ ] 메인 페이지 레이아웃
- [ ] 폼 요소 (URL, 옵션)
- [ ] 진행률 표시 영역
- [ ] 반응형 디자인

#### 2.2 CSS 스타일링
- [ ] 모던한 UI 디자인
- [ ] 다크 모드 지원
- [ ] 애니메이션 효과
- [ ] 모바일 최적화

#### 2.3 JavaScript 로직
- [ ] URL 유효성 검사
- [ ] API 통신 (Fetch)
- [ ] WebSocket 연결 및 메시지 처리
- [ ] 진행률 업데이트
- [ ] 파일 다운로드 트리거
- [ ] 에러 핸들링

### Phase 3: 통합 및 테스트 (1일)

#### 3.1 통합 테스트
- [ ] API 엔드포인트 테스트
- [ ] WebSocket 통신 테스트
- [ ] 전체 다운로드 플로우 테스트

#### 3.2 사용성 테스트
- [ ] 다양한 URL 테스트
- [ ] 에러 케이스 테스트
- [ ] 브라우저 호환성 테스트

#### 3.3 성능 최적화
- [ ] 동시 다운로드 제한
- [ ] 메모리 사용량 최적화
- [ ] 응답 시간 개선

### Phase 4: 문서화 및 배포 (1일)

#### 4.1 문서 작성
- [ ] API 명세서
- [ ] 사용자 가이드
- [ ] 배포 가이드

#### 4.2 배포 준비
- [ ] Docker 이미지 생성
- [ ] 환경 변수 설정
- [ ] 프로덕션 설정

---

## 📦 의존성 추가

### pyproject.toml 업데이트

```toml
dependencies = [
    "yt-dlp>=2024.1.0",
    "click>=8.1.0",
    "rich>=13.7.0",
    "pydantic>=2.5.0",
    "pydantic-settings>=2.1.0",
    "imageio-ffmpeg>=0.4.9",
    # 🆕 웹 인터페이스
    "fastapi>=0.109.0",
    "uvicorn[standard]>=0.27.0",
    "python-multipart>=0.0.6",
    "websockets>=12.0",
    "aiofiles>=23.2.1",
]
```

---

## 🚀 실행 방법

### 개발 모드

```bash
# CLI 실행 (기존)
uv run ytdl download <URL>

# 웹 서버 실행 (신규)
uv run uvicorn youtube_downloader.web.app:app --reload

# 브라우저에서 접속
http://localhost:8000
```

### 프로덕션 모드

```bash
# Docker로 실행
docker build -t youtube-downloader-web .
docker run -p 8000:8000 youtube-downloader-web
```

---

## ✅ 검증 계획

### 기능 테스트
1. **URL 입력 및 정보 조회**
   - 유효한 URL 입력 시 동영상 정보 표시
   - 잘못된 URL 입력 시 에러 메시지 표시

2. **다운로드 기능**
   - 다양한 화질 옵션 테스트
   - 오디오 전용 다운로드 테스트
   - 진행률 실시간 업데이트 확인

3. **에러 처리**
   - 네트워크 오류 처리
   - 서버 오류 처리
   - 사용자 친화적 에러 메시지

### 성능 테스트
- 동시 다운로드 처리 (최대 5개)
- 대용량 파일 다운로드 (4K 영상)
- 메모리 누수 확인

### 보안 테스트
- URL 인젝션 방지
- 파일 경로 탐색 방지
- CORS 설정 확인

---

## 🎨 디자인 가이드라인

### 색상 팔레트
- **Primary**: #FF0000 (YouTube Red)
- **Secondary**: #282828 (Dark Gray)
- **Background**: #FFFFFF (Light) / #181818 (Dark)
- **Text**: #030303 (Light) / #FFFFFF (Dark)
- **Success**: #00C853
- **Error**: #D32F2F

### 타이포그래피
- **헤딩**: Roboto Bold
- **본문**: Roboto Regular
- **코드**: Roboto Mono

### 반응형 브레이크포인트
- **Mobile**: < 768px
- **Tablet**: 768px ~ 1024px
- **Desktop**: > 1024px

---

## 🚧 마일스톤

| 단계 | 기간 | 주요 산출물 |
|------|------|------------|
| Phase 1 | 2일 | 백엔드 API 완성 |
| Phase 2 | 2일 | 프론트엔드 UI 완성 |
| Phase 3 | 1일 | 통합 및 테스트 |
| Phase 4 | 1일 | 문서화 및 배포 |
| **총계** | **6일** | **웹 인터페이스 배포** |

---

## 📝 참고사항

### 보안 고려사항
- 다운로드 파일 크기 제한 (예: 2GB)
- Rate limiting (IP당 시간당 요청 제한)
- 임시 파일 자동 삭제 (1시간 후)
- HTTPS 사용 권장

### 법적 고려사항
- 유튜브 서비스 약관 준수
- 저작권 보호 콘텐츠 다운로드 주의
- 사용자 책임 명시

### 향후 개선 사항
- 사용자 계정 시스템
- 다운로드 이력 클라우드 동기화
- 재생목록 다운로드 지원
- 다중 플랫폼 지원 (Vimeo, Twitch)
- PWA (Progressive Web App) 지원
- 다국어 지원

---

## 📚 관련 문서
- [CLI 작업 계획서](../01-작업-계획서.md)
- [API 명세서](./02-API-명세서.md) (작성 예정)
- [배포 가이드](./03-배포-가이드.md) (작성 예정)
- [사용자 가이드](../05-사용자-가이드.md)
