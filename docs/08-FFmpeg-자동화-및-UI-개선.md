# FFmpeg 자동화 및 UI 개선 작업 내역

이 문서는 FFmpeg 자동 감지 기능 구현과 CLI 사용자 인터페이스(UI) 개선 작업 내용을 요약합니다.

## 변경 사항

### 1. FFmpeg 자동 감지 구현
사용자가 별도로 FFmpeg를 설치해야 하는 불편함을 해소하기 위해 `imageio-ffmpeg` 패키지를 통합했습니다.

- **의존성 추가**: `pyproject.toml`에 `imageio-ffmpeg`를 추가했습니다.
- **로직 변경**: `downloader.py`에서 시스템에 설치된 FFmpeg가 감지되지 않을 경우, 자동으로 `imageio-ffmpeg`가 제공하는 바이너리를 사용하도록 폴백(Fallback) 로직을 구현했습니다.

### 2. UI 및 진행률 표시 개선
진행률 바가 "100/100 bytes"로 잘못 표시되거나 화면 레이아웃이 깨지는 문제를 수정했습니다.

- **단위 표시 수정**: `cli.py`에서 백분율을 미리 계산해서 넘기는 방식 대신, 실제 바이트 수(`downloaded_bytes`, `total_bytes`)를 `rich` 라이브러리에 전달하여 "15.2 MB"와 같이 정확한 단위가 표시되도록 했습니다.
- **추정 크기 지원**: 전체 파일 크기를 알 수 없는 스트리밍 다운로드 등을 위해 `total_bytes_estimate` 값을 지원하도록 개선했습니다.
- **깔끔한 출력**: 다운로드 상태 메시지가 진행률 바를 깨뜨리지 않도록, `Downloader` 클래스에 `message_callback` 패턴을 도입하여 안전하게 메시지를 출력하도록 리팩토링했습니다.

## 검증 결과

### 수동 테스트
다음 시나리오에 대한 검증을 완료했습니다:
1. **FFmpeg 미설치 환경**: 시스템 FFmpeg 없이도 `imageio-ffmpeg` 바이너리를 통해 다운로드 및 병합이 정상적으로 수행됨을 확인했습니다.
2. **진행률 표시**: "100/100 bytes" 대신 실제 용량(예: 213.8MB)이 정상적으로 표시됨을 확인했습니다.
3. **다운로드 성공**: 유튜브 라이브 스트림 아카이브 다운로드가 성공적으로 완료되었습니다.

## 코드 수정 내역

- `yt_dlp` 임포트 누락 수정
- 중복된 `try-except` 블록으로 인한 `SyntaxError` 수정
